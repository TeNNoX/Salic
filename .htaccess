## Rewrite requests to the php file that handles it.
## Order: most specific > less specific
<IfModule mod_rewrite.c>
  RewriteEngine on


  # /static/img/*.jpg -> ImgSteward
  RewriteRule ^static/img/(.+)\.jpg$ img_steward.php?img_path=$1.jpg [END,QSA]
  # /static/...
  RewriteRule ^static/(.+)$ site/static/$1 [END]
  # /salic/static/...
  RewriteRule ^salic/static/(.+)$ salic/static/$1 [END]

  # Force trailing slash
  # condition: no trailing slash, no extension and not homepage (http://www.bla.de/)
  RewriteCond %{REQUEST_URI} !(/$|\.[^/]*$|^$)
  RewriteRule (.*) %{REQUEST_URI}/ [R=301,END]


  # /edit/lang/PAGE/save[/]
  RewriteRule ^edit/([A-z_-]+)/(.+)/save/?$ save.php?lang=$1&page=$2 [END,QSD] # QSD = discard other GET params
  # /edit/lang/[PAGE][/]    (no page = homepage)
  RewriteRule ^edit/([A-z_-]+)/(.*?)/?$ edit.php?lang=$1&page=$2 [END,QSD] #TODO: '/edit/en'
  # /edit/PAGE[/] > TODO:? 'no language'-link support
  # /edit[/]
  RewriteRule ^edit/?$ edit.php [END,QSD]

  # /backend/navigation[/]
  RewriteRule ^backend/navigation/?$ backend.php?section=nav [END,QSD] # QSD = discard other GET params
  # /backend/page/PAGEKEY[/]
  RewriteRule ^backend/pages/(.*?)/?$ backend.php?section=pages&page=$1 [END,QSD] # QSD = discard other GET params
  # /backend[/]
  RewriteRule ^backend/?$ backend.php [END,QSD]

  # /LANG/[PAGE][/]    (no page = homepage)
  RewriteRule ^([A-z_-]+)/(.*?)/?$ index.php?lang=$1&page=$2 [END,QSD]
  # /PAGE[/]
  #RewriteRule ^([^/]*)/?$ index.php?page=$1 [END,QSD]
  # /
  RewriteRule ^$ index.php [END,QSD]

  # EVERYTHING ELSE
  RewriteRule .* index.php?page=404 [END,QSD]
</IfModule>
